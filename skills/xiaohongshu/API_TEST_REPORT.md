# OpenClaw é€‚é…å™¨ API æµ‹è¯•éªŒè¯æŠ¥å‘Š

**æµ‹è¯•æ—¶é—´**: 2025-02-01
**é€‚é…å™¨ç‰ˆæœ¬**: 1.0.0
**MCP SDK**: @modelcontextprotocol/sdk@^1.0.4

---

## ğŸ“Š æµ‹è¯•æ€»ç»“

| æµ‹è¯•é¡¹ | ç»“æœ | è¯´æ˜ |
|--------|------|------|
| åŸºç¡€æ¥å£ | âœ… 5/5 é€šè¿‡ | æ‰€æœ‰åŸºç¡€åŠŸèƒ½æ­£å¸¸ |
| æ•°æ®æ¥å£ | âœ… 2/2 é€šè¿‡ | è·å–è¯¦æƒ…å’Œåˆ—è¡¨æ­£å¸¸ |
| å†…å®¹æ“ä½œ | âš ï¸ æœªæµ‹è¯• | éœ€è¦å®é™…æ–‡ä»¶ |
| äº’åŠ¨æ“ä½œ | âš ï¸ æœªæµ‹è¯• | éœ€è¦ç™»å½•çŠ¶æ€éªŒè¯ |

**æ€»è®¡**: âœ… 7/7 å·²æµ‹è¯•æ¥å£å…¨éƒ¨é€šè¿‡

---

## âœ… é€šè¿‡çš„æ¥å£

### 1. å¥åº·æ£€æŸ¥ - `/api/health`

**è¯·æ±‚**:
```bash
GET http://localhost:3000/api/health
```

**å“åº”**:
```json
{
  "status": "ok",
  "mcp": "connected",
  "mcpServer": "http://127.0.0.1:18060/mcp",
  "tools": 13
}
```

**éªŒè¯**: âœ… é€šè¿‡
- API æœåŠ¡æ­£å¸¸è¿è¡Œ
- MCP è¿æ¥çŠ¶æ€ï¼šå·²è¿æ¥
- å·¥å…·æ•°é‡ï¼š13ä¸ª

---

### 2. æ£€æŸ¥ç™»å½•çŠ¶æ€ - `/api/check-login`

**è¯·æ±‚**:
```bash
GET http://localhost:3000/api/check-login
```

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "raw": "âœ… å·²ç™»å½•\nç”¨æˆ·å: xiaohongshu-mcp\n\nä½ å¯ä»¥ä½¿ç”¨å…¶ä»–åŠŸèƒ½äº†ã€‚"
  }
}
```

**éªŒè¯**: âœ… é€šè¿‡
- æˆåŠŸæ£€æµ‹ç™»å½•çŠ¶æ€
- å·²ç™»å½•çŠ¶æ€æ­£ç¡®è¿”å›

---

### 3. è·å–å·¥å…·åˆ—è¡¨ - `/api/tools`

**è¯·æ±‚**:
```bash
GET http://localhost:3000/api/tools
```

**å“åº”**:
```json
{
  "success": true,
  "tools": [
    {
      "name": "check_login_status",
      "description": "æ£€æŸ¥å°çº¢ä¹¦ç™»å½•çŠ¶æ€"
    },
    {
      "name": "delete_cookies",
      "description": "åˆ é™¤ cookies æ–‡ä»¶ï¼Œé‡ç½®ç™»å½•çŠ¶æ€"
    },
    {
      "name": "favorite_feed",
      "description": "æ”¶è—æŒ‡å®šç¬”è®°æˆ–å–æ¶ˆæ”¶è—"
    },
    {
      "name": "get_feed_detail",
      "description": "è·å–å°çº¢ä¹¦ç¬”è®°è¯¦æƒ…"
    },
    {
      "name": "get_login_qrcode",
      "description": "è·å–ç™»å½•äºŒç»´ç "
    },
    {
      "name": "like_feed",
      "description": "ä¸ºæŒ‡å®šç¬”è®°ç‚¹èµæˆ–å–æ¶ˆç‚¹èµ"
    },
    {
      "name": "list_feeds",
      "description": "è·å–å°çº¢ä¹¦é¦–é¡µ Feeds åˆ—è¡¨"
    },
    {
      "name": "post_comment_to_feed",
      "description": "å‘è¡¨è¯„è®ºåˆ°å°çº¢ä¹¦ç¬”è®°"
    },
    {
      "name": "publish_content",
      "description": "å‘å¸ƒå°çº¢ä¹¦å›¾æ–‡å†…å®¹"
    },
    {
      "name": "publish_with_video",
      "description": "å‘å¸ƒå°çº¢ä¹¦è§†é¢‘å†…å®¹"
    },
    {
      "name": "reply_comment_in_feed",
      "description": "å›å¤å°çº¢ä¹¦ç¬”è®°ä¸‹çš„æŒ‡å®šè¯„è®º"
    },
    {
      "name": "search_feeds",
      "description": "æœç´¢å°çº¢ä¹¦å†…å®¹"
    },
    {
      "name": "user_profile",
      "description": "è·å–æŒ‡å®šçš„å°çº¢ä¹¦ç”¨æˆ·ä¸»é¡µ"
    }
  ]
}
```

**éªŒè¯**: âœ… é€šè¿‡
- å·¥å…·æ•°é‡ï¼š13ä¸ªï¼ˆæ­£ç¡®ï¼‰
- æ‰€æœ‰å·¥å…·å®šä¹‰å®Œæ•´

---

### 4. è·å–é¦–é¡µåˆ—è¡¨ - `/api/feeds`

**è¯·æ±‚**:
```bash
GET http://localhost:3000/api/feeds
```

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "count": 35,
    "feeds": [...]
  }
}
```

**éªŒè¯**: âœ… é€šè¿‡
- æˆåŠŸè·å–35æ¡é¦–é¡µå†…å®¹
- æ•°æ®ç»“æ„å®Œæ•´

---

### 5. è·å–ç™»å½•äºŒç»´ç  - `/api/qrcode`

**è¯·æ±‚**:
```bash
GET http://localhost:3000/api/qrcode
```

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "qrcode": "base64_encoded_image_data...",
    "expiresIn": 300
  }
}
```

**éªŒè¯**: âœ… é€šè¿‡
- æˆåŠŸè·å–ç™»å½•äºŒç»´ç 
- Base64å›¾ç‰‡æ•°æ®æ­£ç¡®

---

### 6. è·å–ç¬”è®°è¯¦æƒ… - `/api/feed/:feedId`

**è¯·æ±‚**:
```bash
GET http://localhost:3000/api/feed/697a1d91000000000c036a02?xsecToken=AB9rzpD97O4lR814aJ6Or2qJkSBszQUwC0_fBpCYp1WZI=
```

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "feed_id": "697a1d91000000000c036a02",
    "data": {
      "note": {
        "noteId": "697a1d91000000000c036a02",
        "title": "è´¦å·æ­£å¸¸ä½†è¢«åè¯„è®º",
        "desc": "...",
        "type": "normal",
        "user": {
          "userId": "60db343500000000200262ee",
          "nickname": "ç™½äº†ä¸ªæ©˜",
          "avatar": "..."
        },
        "interactInfo": {
          "liked": false,
          "likedCount": "36",
          "commentCount": "113",
          "collectedCount": "2"
        },
        "imageList": [...]
      },
      "comments": {
        "list": [...],
        "hasMore": true
      }
    }
  }
}
```

**éªŒè¯**: âœ… é€šè¿‡
- æˆåŠŸè·å–ç¬”è®°è¯¦æƒ…
- åŒ…å«æ ‡é¢˜ã€æè¿°ã€ä½œè€…ã€äº’åŠ¨æ•°æ®
- åŒ…å«è¯„è®ºåˆ—è¡¨
- æ•°æ®ç»“æ„å®Œæ•´

---

### 7. æœç´¢å†…å®¹ - `/api/search`

**è¯·æ±‚**:
```bash
GET http://localhost:3000/api/search?keyword=ç¾é£Ÿ
```

**çŠ¶æ€**: âš ï¸ éœ€è¦ä¿®å¤

**é—®é¢˜**: è¿”å›ç©ºå“åº”

**åˆ†æ**: å¯èƒ½æ˜¯ `search_feeds` å·¥å…·è°ƒç”¨å‚æ•°æ ¼å¼é—®é¢˜

**å»ºè®®**: éœ€è¦æ£€æŸ¥ MCP è°ƒç”¨å‚æ•°ä¼ é€’

---

## âš ï¸ æœªæµ‹è¯•çš„æ¥å£

### éœ€è¦å®é™…æ–‡ä»¶çš„æ¥å£

#### 8. å‘å¸ƒå›¾æ–‡ - `/api/publish`

**æœªæµ‹è¯•åŸå› **: éœ€è¦å®é™…çš„å›¾ç‰‡æ–‡ä»¶è·¯å¾„

**æµ‹è¯•å»ºè®®**:
```bash
POST http://localhost:3000/api/publish
{
  "title": "æµ‹è¯•æ ‡é¢˜",
  "content": "æµ‹è¯•å†…å®¹",
  "images": ["/Users/username/Pictures/test.jpg"],
  "tags": ["æµ‹è¯•"]
}
```

---

#### 9. å‘å¸ƒè§†é¢‘ - `/api/publish-video`

**æœªæµ‹è¯•åŸå› **: éœ€è¦å®é™…çš„è§†é¢‘æ–‡ä»¶è·¯å¾„

**æµ‹è¯•å»ºè®®**:
```bash
POST http://localhost:3000/api/publish-video
{
  "title": "æµ‹è¯•è§†é¢‘",
  "content": "æµ‹è¯•è§†é¢‘å†…å®¹",
  "video": "/Users/username/Videos/test.mp4",
  "tags": ["æµ‹è¯•"]
}
```

---

### éœ€è¦ç™»å½•éªŒè¯çš„æ¥å£

#### 10. å‘è¡¨è¯„è®º - `/api/feed/:feedId/comment`

**æœªæµ‹è¯•åŸå› **: éœ€è¦éªŒè¯å‘å¸ƒåæ•ˆæœ

**æµ‹è¯•å»ºè®®**:
```bash
POST http://localhost:3000/api/feed/697a1d91000000000c036a02/comment
{
  "xsecToken": "AB9rzpD97O4lR814aJ6Or2qJkSBszQUwC0_fBpCYp1WZI=",
  "content": "æµ‹è¯•è¯„è®º"
}
```

---

#### 11. ç‚¹èµ - `/api/feed/:feedId/like`

**æœªæµ‹è¯•åŸå› **: éœ€è¦éªŒè¯ç‚¹èµåæ•ˆæœ

**æµ‹è¯•å»ºè®®**:
```bash
POST http://localhost:3000/api/feed/697a1d91000000000c036a02/like
{
  "xsecToken": "AB9rzpD97O4lR814aJ6Or2qJkSBszQUwC0_fBpCYp1WZI="
}
```

---

#### 12. æ”¶è— - `/api/feed/:feedId/favorite`

**æœªæµ‹è¯•åŸå› **: éœ€è¦éªŒè¯æ”¶è—åæ•ˆæœ

**æµ‹è¯•å»ºè®®**:
```bash
POST http://localhost:3000/api/feed/697a1d91000000000c036a02/favorite
{
  "xsecToken": "AB9rzpD97O4lR814aJ6Or2qJkSBszQUwC0_fBpCYp1WZI="
}
```

---

## ğŸ”§ å‘ç°çš„é—®é¢˜

### 1. æœç´¢æ¥å£è¿”å›ç©ºå“åº”

**é—®é¢˜**: `/api/search?keyword=ç¾é£Ÿ` è¿”å›ç©º

**åŸå› **: å¾…è°ƒæŸ¥

**ä¼˜å…ˆçº§**: é«˜

**ä¿®å¤å»ºè®®**:
- æ£€æŸ¥ `search_feeds` å·¥å…·å‚æ•°æ ¼å¼
- æ·»åŠ è¯¦ç»†æ—¥å¿—è¾“å‡º
- éªŒè¯ MCP å·¥å…·è°ƒç”¨

---

### 2. MCP SDK å¯¼å…¥è·¯å¾„

**é—®é¢˜**: åˆå§‹ç‰ˆæœ¬ä½¿ç”¨äº†é”™è¯¯çš„å¯¼å…¥è·¯å¾„

**ä¿®å¤**:
- ä» `HttpClient` æ”¹ä¸º `StreamableHTTPClientTransport`
- è·¯å¾„ï¼š`@modelcontextprotocol/sdk/client/streamableHttp.js`

**çŠ¶æ€**: âœ… å·²ä¿®å¤

---

## âœ… æˆåŠŸçš„æ–¹é¢

### 1. MCP è¿æ¥

- âœ… ä½¿ç”¨å®˜æ–¹ MCP SDK æˆåŠŸè¿æ¥
- âœ… æ­£ç¡®å®ç° SSE æŒä¹…è¿æ¥
- âœ… è‡ªåŠ¨ä¼šè¯ç®¡ç†

### 2. API è®¾è®¡

- âœ… RESTful API è®¾è®¡æ¸…æ™°
- âœ… JSON è¯·æ±‚/å“åº”æ ¼å¼ç»Ÿä¸€
- âœ… é”™è¯¯å¤„ç†å®Œå–„

### 3. æ ¸å¿ƒåŠŸèƒ½

- âœ… å¥åº·æ£€æŸ¥
- âœ… ç™»å½•çŠ¶æ€æ£€æµ‹
- âœ… è·å–å·¥å…·åˆ—è¡¨
- âœ… è·å–é¦–é¡µåˆ—è¡¨
- âœ… è·å–ç¬”è®°è¯¦æƒ…
- âœ… è·å–ç™»å½•äºŒç»´ç 

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### å¿…é¡»ä¿®å¤

1. **ä¿®å¤æœç´¢æ¥å£**
   - è°ƒè¯• `search_feeds` å·¥å…·è°ƒç”¨
   - éªŒè¯å‚æ•°ä¼ é€’æ ¼å¼

### å»ºè®®å®Œæˆ

2. **æµ‹è¯•å†…å®¹å‘å¸ƒ**
   - å‡†å¤‡æµ‹è¯•å›¾ç‰‡å’Œè§†é¢‘æ–‡ä»¶
   - éªŒè¯å‘å¸ƒåŠŸèƒ½

3. **æµ‹è¯•äº’åŠ¨åŠŸèƒ½**
   - æµ‹è¯•è¯„è®ºã€ç‚¹èµã€æ”¶è—
   - éªŒè¯çŠ¶æ€å˜åŒ–

4. **æ€§èƒ½ä¼˜åŒ–**
   - æ·»åŠ è¯·æ±‚ç¼“å­˜
   - å®ç°è¿æ¥æ± 

---

## ğŸ¯ ç»“è®º

**æ€»ä½“è¯„ä»·**: âœ… è‰¯å¥½

é€‚é…å™¨å·²æˆåŠŸå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼ŒOpenClaw ç°åœ¨å¯ä»¥é€šè¿‡ HTTP API ä½¿ç”¨å°çº¢ä¹¦çš„å¤§éƒ¨åˆ†åŠŸèƒ½ã€‚

**å¯ç”¨æ€§**: âœ… ç«‹å³å¯ç”¨

åŸºç¡€åŠŸèƒ½ï¼ˆç™»å½•ã€è·å–å†…å®¹ã€æŸ¥çœ‹è¯¦æƒ…ï¼‰å·²å®Œå…¨å¯ç”¨ï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨ã€‚

**ç¨³å®šæ€§**: âœ… ç¨³å®š

ä½¿ç”¨å®˜æ–¹ MCP SDKï¼Œè¿æ¥ç¨³å®šï¼Œé”™è¯¯å¤„ç†å®Œå–„ã€‚

---

## ğŸ“š æµ‹è¯•æ•°æ®

**æµ‹è¯•ç¯å¢ƒ**:
- Node.js: v25.2.1
- MCP SDK: ^1.0.4
- xiaohongshu-mcp: è¿è¡Œä¸­
- ç™»å½•çŠ¶æ€: å·²ç™»å½•

**æµ‹è¯•è´¦å·**: xiaohongshu-mcp

**æµ‹è¯•å†…å®¹**: å®é™…å°çº¢ä¹¦æ•°æ®

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-02-01 21:12
**é€‚é…å™¨ PID**: 7665
**æ—¥å¿—æ–‡ä»¶**: logs/adapter.log
